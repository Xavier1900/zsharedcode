#summary IEBrowser 登录 163 发布日志
#labels Phase-Implementation
<font face="microsoft yahei">
=== 简介 ===
 示例编写者: 雪鱼
 功能: 完成 163 博客的登录和日志的发布
 修正&分析: M.S.cxc

=== 代码 ===
{{{
// 从当前的 WebBrowser 控件创建 IEBrowser 对象.
IEBrowser ie = new IEBrowser ( this.webBrowser );

// 此处修改为您的 163 博客地址.
ie.Navigate ( "http://<163 博客地址>" );
ie.IEFlow.Wait ( 3 );

// 安装 jquery 脚本.
ie.InstallTrace ( );
ie.InstallScript ( Properties.Resources.jquery_1_5_2_min, "jsJQuery" );

// 弹出登录框.
ie.ExecuteJQuery ( JQuery.Create ( "'a:contains(登录)'" ).Attr ( "'id'", "'denglu'" ) );
ie.ExecuteScript ( "document.getElementById('denglu').click();" );

// 填写用户信息并登录.
ie.ExecuteJQuery ( JQuery.Create ( "'.ztxt:text'" ).Val ( "'<用户名>'" ) );
ie.ExecuteJQuery ( JQuery.Create ( "'.ztxt:password'" ).Val ( "'<密码>'" ) );
ie.ExecuteJQuery ( JQuery.Create ( "'.wbtnok:button'" ).Attr ( "'id'", "'dl'" ) );
ie.ExecuteScript ( "document.getElementById('dl').click();" );
ie.IEFlow.Wait ( 5 );

// 安装 jquery 脚本.
ie.InstallTrace ( );
ie.InstallScript ( Properties.Resources.jquery_1_5_2_min, "jsJQuery" );

// 跳转到日志页面.
ie.ExecuteJQuery ( JQuery.Create ( "'a:contains(日志)' " ).Attr ( "'id'", "'rz'" ) );
ie.ExecuteScript ( "document.getElementById('rz').click();" );
ie.IEFlow.Wait ( 5 );

// 安装 jquery 脚本.
ie.InstallTrace ( );
ie.InstallScript ( Properties.Resources.jquery_1_5_2_min, "jsJQuery" );

// 跳转到编辑日志页面.
ie.ExecuteJQuery ( JQuery.Create ( "'a:contains(写日志)' " ).Attr ( "'id'", "'xrz'" ) );
ie.ExecuteScript ( "document.getElementById('xrz').click();" );
ie.IEFlow.Wait ( 5 );

// 安装 jquery 脚本.
ie.InstallTrace ( );
ie.InstallScript ( Properties.Resources.jquery_1_5_2_min, "jsJQuery" );

// 填写日志内容.
ie.ExecuteJQuery ( JQuery.Create ( "'.ztag:text'" ).Val ( "'<标题>'" ) );
ie.ExecuteJQuery ( JQuery.Create ( "'#ne-auto-id-source'" ).Trigger ( "'click'" ) );

ie.ExecuteJQuery ( JQuery.Create ( "'textarea.ztag'" ).Val ( string.Format ( "'{0}'", IEBrowser.EscapeCharacter ( "<日志 html 代码>" ) ) ) );

ie.ExecuteJQuery ( JQuery.Create ( "'#ne-auto-id-source'" ).Trigger ( "'click'" ) );

ie.ExecuteScript ( "document.getElementById('key-093402170-autotag').click();" );
ie.IEFlow.Wait ( 5 );

// 发布日志.
ie.ExecuteJQuery ( JQuery.Create ( "'.fc09:button'" ).Attr ( "'id'", "'fb'" ) );
ie.ExecuteScript ( "document.getElementById('fb').click();" );
}}}

=== 说明 ===
 页面跳转的代码是十分的简单的, 使用 [IEBrowser IEBrowser] 的 Navigate 方法即可.

 _这里仅列出部分代码, 可能需要您自己创建窗口, 页面等._

=== 使用 ===
 如果需要单独使用 [IEBrowser IEBrowser], 可以下载 [http://zsharedcode.googlecode.com/svn/trunk/zsharedcode/panzer/.code/IEBrowser.all.cs IEBrowser.all.cs] 或者 [http://zsharedcode.googlecode.com/svn/trunk/zsharedcode/panzer/.code/IEBrowser.with.HtmlEditHelper.all.cs IEBrowser.with.HtmlEditHelper.all.cs].

 如果下载整个 *panzer* 项目, 请参考 [HowToDownloadAndUse 如何下载使用].

=== 需求 ===
 可能需要引用 System.Web 以及相关程序集.
</font>